# BFLA COCO Annotator in DELETE /api/undo/
<div align="center">
  <a href="https://thoropass.com" target="_blank" rel="noopener noreferrer">
    <img src="https://github.com/user-attachments/assets/b3bbec80-2537-4578-889e-18eaad0d1194" width="150" alt="Thoropass Logo">
  </a>
  <br><br>
  <a href="https://thoropass.com" target="_blank" rel="noopener noreferrer">
    <img src="https://img.shields.io/badge/ðŸŒ_WEBSITE-THOROPASS-0078D4?style=for-the-badge" alt="Website">
  </a>
  <a href="https://linkedin.com/in/seu-perfil" target="_blank" rel="noopener noreferrer">
    <img src="https://img.shields.io/badge/LINKEDIN-CONNECT-0077B5?style=for-the-badge&logo=linkedin&logoColor=white" alt="LinkedIn">
  </a>
  
  <h1>Thoropass Vulnerability Research Program</h1>
</div>
<table>
 <tr>
    <td><strong>Author</strong></td>
    <td><a href="https://www.linkedin.com/in/nmmorette/">Natan Morette</a> on behalf of <a href="https://thoropass.com">Thoropass</a></td>
  </tr>
  <tr>
    <td><strong>Affected Application</strong></td>
    <td>
      <a href="https://github.com/jsbroks/coco-annotator">COCO Annotator</a><br>
      <small>
        Open-source, web-based image annotation platform used to build datasets
        for computer vision and machine learning workflows, supporting the COCO
        dataset format.
      </small>
    </td>
  </tr>
  <tr>
    <td><strong>Affected Version</strong></td>
    <td>0.11.1</td>
  </tr>
  <tr>
    <td><strong>Endpoint</strong></td>
    <td><code>/api/undo/</code></td>
  </tr>
  <tr>
    <td><strong>Vulnerability Type</strong></td>
    <td>Broken Function Level Authorization</td>
  </tr>
</table>

## **Summary**

An attacker can delete categories created by other users via a DELETE request to the `/api/undo/` endpoint without any ownership or permission checks. This constitutes a **Broken Function Level Authorization (BFLA)** vulnerability, allowing unauthorized manipulation of protected resources.



## **Technical Details**

âž¤ Vulnerable Endpoint:Â `/api/undo/`

âž¤ Parameter:Â `?id=`

---


### **PoC (Proof of Concept)**

**1. Create a new category with a user with admin privileges:**

![image.png](image.png)

**2. Then, with another non-admin user send a request to delete the category; in this case, the admin created the category with ID 200.**

Request to view ID 200 category failed because users can only see their own category.

![image.png](image%201.png)

**3. Send a DELETE request to the endpoint `/api/undo`to delete the ID 200 category:**

![image.png](image%202.png)

**4. Note the application accepts the requests without validating that the user has permission to delete this category**

---

An attacker can exploit this vulnerability to delete all categories within the application.


    
<p align="center">
  <img src="image%203.png" alt="image">
  <br>
  <em>Checking all categories before the attack</em>
</p>
    


<p align="center">
  <img src="image%204.png" alt="image">
  <br>
  <em>Executing the attack to delete category IDs ranging from 1 to 200</em>
</p>



<p align="center">
  <img src="image%205.png" alt="image">
  <br>
  <em>Checking the results returned a Status 200 with a success message. A normal user was able to delete all categories in the application</em>
</p>



<p align="center">
  <img src="image%206.png" alt="image">
  <br>
  <em>Confirm that the application currently has no categories after the attack</em>
</p>


## **Impact**

- Any authenticated user can delete categories created by other users.
- No verification is done to ensure that the requester is the original creator or has elevated permissions (e.g., admin).
- Leads to **data integrity issues**, potential **denial of service**, or abuse in **multi-tenant environments**.

---

## **References**

- [OWASP API Security Top 10 â€“ BFLA](https://owasp.org/API-Security/editions/2023/en/0xa5-broken-function-level-authorization/)
- CWE-285: Improper Authorization

---


## About Thoropass
Thoropass delivers enterprise-grade audits with AI-native speed and precision. Designed from day one to integrate auditors, automation, and infosec workflows in a single, closed-loop system â€” no add-ons, no handoffs.


<div align="center">
  <a href="https://thoropass.com" target="_blank" rel="noopener noreferrer">
    <img src="https://img.shields.io/badge/ðŸŒ_WEBSITE-THOROPASS-0078D4?style=for-the-badge" alt="Website">
  </a>
  <a href="https://linkedin.com/in/seu-perfil" target="_blank" rel="noopener noreferrer">
    <img src="https://img.shields.io/badge/LINKEDIN-CONNECT-0077B5?style=for-the-badge&logo=linkedin&logoColor=white" alt="LinkedIn">
  </a>
  <br><br>
  <a href="https://thoropass.com" target="_blank" rel="noopener noreferrer">
    <img width="100%" alt="Thoropass" src="https://github.com/user-attachments/assets/557c3c6e-bc2d-4b0e-90cb-503767a0aa23">
  </a>
</div>

